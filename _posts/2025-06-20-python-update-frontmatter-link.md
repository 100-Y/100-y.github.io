---
layout: post
title: ç”¨ Python è„šæœ¬è‡ªåŠ¨åŒæ­¥ Markdown æ–‡ç«  Front Matter çš„å›¾ç‰‡é“¾æ¥
date: 2025-06-20
description: é€šè¿‡ Python è„šæœ¬æ‰¹é‡æ›´æ–° åšå®¢ Front Matter ä¸­çš„å›¾ç‰‡å­—æ®µï¼Œå®ç°æ–‡ç« ä¸å›¾ç‰‡æ–‡ä»¶åè‡ªåŠ¨åŒ¹é…ï¼Œæå‡ç»´æŠ¤æ•ˆç‡ã€‚
og_image: /assets/img/blog/python-update-frontmatter-link.webp
thumbnail: /assets/img/blog/python-update-frontmatter-link.webp
categories: Internet
tags: python frontmatter
giscus_comments: true
---

<img src="/assets/img/blog/python-update-frontmatter-link.webp" style="width:100%;" alt="python-update-frontmatter-link">

## ä¸€ã€èƒŒæ™¯

---

åœ¨ä¿®æ”¹ Markdown æ–‡ç« æ—¶ï¼Œé€šå¸¸éœ€è¦ä¸ºæ¯ç¯‡æ–‡ç« è®¾ç½® `og_image`ï¼ˆç¤¾äº¤åˆ†äº«å›¾ï¼‰å’Œ `thumbnail`ï¼ˆç¼©ç•¥å›¾ï¼‰ã€‚æ‰‹åŠ¨ç»´æŠ¤è¿™ä¸¤ä¸ªå­—æ®µå¾€å¾€è´¹æ—¶ä¸”æ˜“é”™ï¼Œå°¤å…¶å½“å›¾ç‰‡æ–‡ä»¶åä¸æ–‡ç« æ–‡ä»¶åä¸¥æ ¼å¯¹åº”æ—¶ï¼Œè‡ªåŠ¨åŒ–è„šæœ¬å°±èƒ½æ´¾ä¸Šç”¨åœºã€‚é€šè¿‡ç®€å•çš„ Python è„šæœ¬ï¼Œæ‰¹é‡æ›´æ–°åšå®¢æ–‡ç«  Front Matter ä¸­çš„ `og_image` å’Œ `thumbnail` å­—æ®µï¼Œä½¿å…¶å’Œæœ¬åœ°å›¾ç‰‡æ–‡ä»¶åä¿æŒä¸€è‡´ï¼Œæå¤§æå‡å†…å®¹ç»´æŠ¤æ•ˆç‡ã€‚

---

## äºŒã€éœ€æ±‚åˆ†æ

---

- åšå®¢æ–‡ç« ä½äº `_posts` æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶åæ ¼å¼å½¢å¦‚ï¼š
  `2025-06-20-my-post.md`
- å¯¹åº”å›¾ç‰‡å­˜æ”¾åœ¨ `assets/img/blog/`ï¼Œå›¾ç‰‡æ–‡ä»¶åå½¢å¦‚ï¼š
  `my-post.webp`
- å¸Œæœ›è‡ªåŠ¨å°†æ¯ç¯‡æ–‡ç«  Front Matter ä¸­çš„ `og_image` å’Œ `thumbnail` æŒ‡å‘å¯¹åº”å›¾ç‰‡çš„è·¯å¾„ï¼š
  `/assets/img/blog/my-post.webp`
- å¦‚æœå­—æ®µä¸å­˜åœ¨ï¼Œè‡ªåŠ¨æ’å…¥ `og_image` åœ¨å‰ã€`thumbnail` åœ¨å
- ä¸ä¿®æ”¹æ­£æ–‡å†…å®¹ï¼Œä»…å¤„ç† Front Matter
- ä¿æŒåŸæœ‰çš„å›¾ç‰‡è·¯å¾„å‰ç¼€ï¼Œæ›¿æ¢æ–‡ä»¶åéƒ¨åˆ†

---

## ä¸‰ã€è§£å†³æ–¹æ¡ˆ

---

åˆ©ç”¨ Python è„šæœ¬éå†æ‰€æœ‰æ–‡ç« ï¼ŒåŒ¹é…å¯¹åº”å›¾ç‰‡æ–‡ä»¶ï¼Œæ›´æ–° Front Matter ä¸­ç›¸å…³å­—æ®µã€‚æ ¸å¿ƒæ­¥éª¤ï¼š

1. **æ–‡ä»¶åŒ¹é…è§„åˆ™**
   å»é™¤æ–‡ç« æ–‡ä»¶åå‰çš„æ—¥æœŸå‰ç¼€ï¼ˆå¦‚ `2025-06-20-`ï¼‰ï¼Œå¾—åˆ° slug
2. **è·¯å¾„æ„é€ **
   æ‹¼æ¥å›¾ç‰‡ç›®å½•è·¯å¾„ï¼Œæ£€æŸ¥å›¾ç‰‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨
3. **Front Matter è¯»å–ä¸ä¿®æ”¹**
   å®šä½ YAML å¤´éƒ¨åŒºåŸŸï¼ŒæŸ¥æ‰¾ `og_image` å’Œ `thumbnail` å­—æ®µ
4. **å­—æ®µæ›´æ–°æˆ–æ’å…¥**
   æ›¿æ¢æˆ–æ–°å¢å­—æ®µï¼Œä¿è¯å­—æ®µé¡ºåºå’Œå†…å®¹æ­£ç¡®
5. **å†™å›æ–‡ä»¶**

---

## å››ã€æœ€ç»ˆè„šæœ¬å±•ç¤º `update_thumbnail.py`

---

```python
import os
import re

# === è®¾ç½®ç›®å½• ===
posts_dir = './_posts'
img_dir = './assets/img/blog'

# è·å– Markdown æ–‡ä»¶åˆ—è¡¨ï¼ˆæŒ‰å­—æ¯æ’åºï¼‰
post_files = sorted([f for f in os.listdir(posts_dir) if f.endswith('.md')])


for post_file in post_files:
    post_name = os.path.splitext(post_file)[0]

    # ğŸŸ¡ å»é™¤æ—¥æœŸå‰ç¼€ï¼Œåªä¿ç•™ slug ä½œä¸ºå›¾ç‰‡ååŒ¹é…
    slug = re.sub(r'^\d{4}-\d{2}-\d{2}-', '', post_name)
    expected_img = slug + ".webp"
    img_path = os.path.join(img_dir, expected_img)

    # å¦‚æœå›¾ç‰‡ä¸å­˜åœ¨ï¼Œè·³è¿‡
    if not os.path.exists(img_path):
        print(f"âš ï¸ ç¼ºå°‘å›¾ç‰‡ï¼š{expected_img}ï¼Œè·³è¿‡ {post_file}")
        continue

    img_name = expected_img
    img_web_path = f"/assets/img/blog/{img_name}"

    # === è¯»å–æ–‡ç« å†…å®¹ ===
    post_path = os.path.join(posts_dir, post_file)
    with open(post_path, 'r', encoding='utf-8') as f:
        lines = f.readlines()

    # === å®šä½ Front Matterï¼ˆYAMLï¼‰èŒƒå›´ ===
    in_front_matter = False
    front_matter_end_idx = 0
    for idx, line in enumerate(lines):
        if line.strip() == '---':
            if not in_front_matter:
                in_front_matter = True
            else:
                front_matter_end_idx = idx
                break

    fm_lines = lines[1:front_matter_end_idx]
    new_fm_lines = []
    og_image_found = False
    thumbnail_found = False

    for line in fm_lines:
        m = re.match(r'^(thumbnail:|og_image:)\s*(.+)$', line)
        if m:
            field_name = m.group(1)
            old_path = m.group(2).strip()
            prefix_match = re.match(r'(.*/)', old_path)
            prefix = prefix_match.group(1) if prefix_match else "/assets/img/blog/"
            new_path = prefix + img_name
            new_fm_lines.append(f"{field_name} {new_path}\n")
            if field_name == "og_image:":
                og_image_found = True
            elif field_name == "thumbnail:":
                thumbnail_found = True
        else:
            new_fm_lines.append(line)

    # === æ’å…¥å­—æ®µï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ ===
    if not og_image_found:
        new_fm_lines.append(f"og_image: {img_web_path}\n")
    if not thumbnail_found:
        new_fm_lines.append(f"thumbnail: {img_web_path}\n")

    # === å†™å›æ–‡ä»¶ï¼šæ›´æ–°åçš„ Front Matter + åŸæ­£æ–‡ ===
    new_lines = ['---\n'] + new_fm_lines + ['---\n'] + lines[front_matter_end_idx + 1:]
    with open(post_path, 'w', encoding='utf-8') as f:
        f.writelines(new_lines)

    print(f"âœ… å·²æ›´æ–° Front Matterï¼š{post_file} â†’ å›¾ç‰‡ {img_name}")
```

---

## äº”ã€ä½¿ç”¨è¯´æ˜

---

- å°†è„šæœ¬ä¿å­˜ä¸º `update_thumbnail.py` æ”¾åœ¨æ–‡ä»¶å¤¹æ ¹ç›®å½•ï¼ˆæ¯”å¦‚`xx`ï¼‰

- ç¡®ä¿ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

  ```
  xx/
  â”œâ”€â”€ update_thumbnail.py
  â”œâ”€â”€ _posts/
  â”‚   â”œâ”€â”€ 2025-06-20-my-post.md
  â”‚   â””â”€â”€ ...
  â””â”€â”€ assets/
      â””â”€â”€ img/
          â””â”€â”€ blog/
              â”œâ”€â”€ my-post.webp
              â””â”€â”€ ...
  ```

- è¿è¡Œè„šæœ¬ï¼š

  ```bash
  cd ~/Desktop/xx
  python3 update_thumbnail.py
  ```

---

## å…­ã€å¤„ç†ç¤ºä¾‹

---

å‡è®¾åŸå§‹ Front Matter æ˜¯ï¼š

```
---
layout: post
title: ç¤ºä¾‹
date: 2025-06-20
---
```

è¿è¡Œååˆ™è‡ªåŠ¨å˜ä¸ºï¼š

```
---
layout: post
title: ç¤ºä¾‹
date: 2025-06-20
og_image: /assets/img/blog/my-post.webp
thumbnail: /assets/img/blog/my-post.webp
---
```
